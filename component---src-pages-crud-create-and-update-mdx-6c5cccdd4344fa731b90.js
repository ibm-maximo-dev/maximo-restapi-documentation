"use strict";(self.webpackChunkmas_playbook=self.webpackChunkmas_playbook||[]).push([[765],{3624:function(e,t,a){a.d(t,{Z:function(){return E}});var n=a(7294),r=a(8650),s=a.n(r),i=a(1597),o=a(811),l=a(87),p=a(5900),d=a.n(p),c=function(e){var t,a=e.title,r=e.theme,s=e.tabs,i=void 0===s?[]:s;return n.createElement("div",{className:d()("PageHeader-module--page-header--NqfPe",(t={},t["PageHeader-module--with-tabs--vbQ-W"]=i.length,t["PageHeader-module--dark-mode--WCeH8"]="dark"===r,t))},n.createElement("div",{className:"bx--grid"},n.createElement("div",{className:"bx--row"},n.createElement("div",{className:"bx--col-lg-12"},n.createElement("h1",{id:"page-title",className:"PageHeader-module--text--Er2EO"},a)))))},h=function(e){var t=e.relativePagePath,a=e.repository,r=(0,i.useStaticQuery)("1364590287").site.siteMetadata.repository,s=a||r,o=s.baseUrl,l=s.subDirectory,p=o+"/edit/"+s.branch+l+"/src/pages"+t;return o?n.createElement("div",{className:"bx--row EditLink-module--row--BEmSX"},n.createElement("div",{className:"bx--col"},n.createElement("a",{className:"EditLink-module--link--IDrl1",href:p},"Edit this page on GitHub"))):null},m=a(4703),u=a(1721),k=function(e){function t(){return e.apply(this,arguments)||this}return(0,u.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.title,a=e.tabs,r=e.slug,o=r.split("/").filter(Boolean).slice(-1)[0],l=a.map((function(e){var t,a=s()(e,{lower:!0,strict:!0}),l=a===o,p=new RegExp(o+"/?(#.*)?$"),c=r.replace(p,a);return n.createElement("li",{key:e,className:d()((t={},t["PageTabs-module--selected-item--aBB0K"]=l,t),"PageTabs-module--list-item--024o6")},n.createElement(i.Link,{className:"PageTabs-module--link--Kz-7R",to:""+c},e))}));return n.createElement("div",{className:"PageTabs-module--tabs-container--Cdfzw"},n.createElement("div",{className:"bx--grid"},n.createElement("div",{className:"bx--row"},n.createElement("div",{className:"bx--col-lg-12 bx--col-no-gutter"},n.createElement("nav",{"aria-label":t},n.createElement("ul",{className:"PageTabs-module--list--xLqxG"},l))))))},t}(n.Component),f=k,N=a(7296),g=a(5387),y=a(3732),w=function(e){var t=e.date,a=new Date(t);return t?n.createElement(y.X2,{className:"last-modified-date-module--row--XJoYQ"},n.createElement(y.sg,null,n.createElement("div",{className:"last-modified-date-module--text--ogPQF"},"Page last updated: ",a.toLocaleDateString("en-GB",{day:"2-digit",year:"numeric",month:"long"})))):null},E=function(e){var t=e.pageContext,a=e.children,r=e.location,p=e.Title,d=t.frontmatter,u=void 0===d?{}:d,k=t.relativePagePath,y=t.titleType,E=u.tabs,b=u.title,C=u.theme,T=u.description,v=u.keywords,x=u.date,P=(0,g.Z)().interiorTheme,R=(0,i.useStaticQuery)("2456312558").site.pathPrefix,I=R?r.pathname.replace(R,""):r.pathname,A=E?I.split("/").filter(Boolean).slice(-1)[0]||s()(E[0],{lower:!0}):"",U=C||P;return n.createElement(l.Z,{tabs:E,homepage:!1,theme:U,pageTitle:b,pageDescription:T,pageKeywords:v,titleType:y},n.createElement(c,{title:p?n.createElement(p,null):b,label:"label",tabs:E,theme:U}),E&&n.createElement(f,{title:b,slug:I,tabs:E,currentTab:A}),n.createElement(N.Z,{padded:!0},a,n.createElement(h,{relativePagePath:k}),n.createElement(w,{date:x})),n.createElement(m.Z,{pageContext:t,location:r,slug:I,tabs:E,currentTab:A}),n.createElement(o.Z,null))}},1221:function(e,t,a){a.r(t),a.d(t,{_frontmatter:function(){return l},default:function(){return h}});var n,r=a(3366),s=(a(7294),a(4983)),i=a(3624),o=["components"],l={},p=(n="InlineNotification",function(e){return console.warn("Component "+n+" was not imported, exported, or provided by MDXProvider as global scope"),(0,s.kt)("div",e)}),d={_frontmatter:l},c=i.Z;function h(e){var t=e.components,a=(0,r.Z)(e,o);return(0,s.kt)(c,Object.assign({},d,a,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h2",null,"Create resources"),(0,s.kt)("p",null,"Creating resources are typically completed by using the collection URI, which is the same URI you use to query the resources. For example, the API call for creating assets is shown in the following example:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"POST /oslc/os/mxapiasset\n")),(0,s.kt)("p",null,"Post body:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "assetnum": "ASSET1",\n  "siteid": "BEDFORD",\n  "description": "my first asset"\n}\n')),(0,s.kt)("p",null,"After you create the asset, you get a response that contains a ",(0,s.kt)("inlineCode",{parentName:"p"},"location")," header with the URI of the new asset. You can now use that ",(0,s.kt)("inlineCode",{parentName:"p"},"location")," URI to fetch the new resource. Rather than doing a ",(0,s.kt)("inlineCode",{parentName:"p"},"GET")," to fetch the resource, you may want the response of the create to contain the new resource. For that, you can add the request header ",(0,s.kt)("inlineCode",{parentName:"p"},"properties"),". The ",(0,s.kt)("inlineCode",{parentName:"p"},"properties")," header follows the syntax of the ",(0,s.kt)("a",{parentName:"p",href:"../query/selecting"},"oslc.select")," clause. You can use that to fetch all properties, partial set of properties, related MBO attributes, formula properties etc (everything that you can do with the select clause)."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'POST /oslc/os/mxapiasset \nproperties: *\n\n{\n  "assetnum": "ASSET1",\n  "siteid": "BEDFORD",\n  "description": "my first asset"\n}\n')),(0,s.kt)("p",null,"Or"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'POST /oslc/os/mxapiasset \nproperties: assetnum,status\n\n{\n  "assetnum": "ASSET1",\n  "siteid": "BEDFORD",\n  "description": "my first asset"\n}\n')),(0,s.kt)("p",null,"Using the ",(0,s.kt)("inlineCode",{parentName:"p"},"properties")," header removes the need to do an extra ",(0,s.kt)("inlineCode",{parentName:"p"},"GET")," for every create and update."),(0,s.kt)("h2",null,"Updating resources"),(0,s.kt)("p",null,"Now that an asset is created, you can update the asset. The following example shows how you can set a ",(0,s.kt)("inlineCode",{parentName:"p"},"location")," and a ",(0,s.kt)("inlineCode",{parentName:"p"},"description")," to the ",(0,s.kt)("inlineCode",{parentName:"p"},"asset"),"."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'POST /oslc/os/mxapiasset/{rest id for the asset} \nx-method-override: PATCH\nproperties:*\n\n{\n  "location": "BR300",\n  "description": "test asset desc"\n}\n')),(0,s.kt)("p",null,"The URL has a ",(0,s.kt)("inlineCode",{parentName:"p"},"rest id")," at the end of the collection URL. This URI is pointing to a member asset in the collection, which is why the ",(0,s.kt)("inlineCode",{parentName:"p"},"rest id")," token is after the collection URI. "),(0,s.kt)(p,{kind:"info",mdxType:"InlineNotification"},"The rest id is not the unique id for the Mbo. It's a generated id for the Mbo that is created using the primary-key attribute values."),(0,s.kt)(p,{kind:"info",mdxType:"InlineNotification"},"x-method-override:PATCH instructs the server side to update the resource. As with create, you can specify the properties request header, to get back the results of an update. The sample here shows a value of *. We would generally recommend avoiding use of * (unless you really want all properties) and instead use the selected set of properties that you care about (works our better for performance)."),(0,s.kt)("p",null,"Note that we needed to fetch the URI of the ",(0,s.kt)("inlineCode",{parentName:"p"},"mxasset")," resource in order to update it. The fetching of that URI can be done in two ways:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"We can get the URI as part of a GET collection query, which returns all select members with their URIs."),(0,s.kt)("li",{parentName:"ul"},"As part of the response ",(0,s.kt)("inlineCode",{parentName:"li"},"location")," header when we create a resource.")),(0,s.kt)("p",null,"Although this is the prevalent design for URI interaction in REST paradigm, in some cases you may not have the URI and still need to update the asset based on other key information."),(0,s.kt)("h2",null,"Add child objects"),(0,s.kt)("p",null,"To add some child objects, the following API example adds two ",(0,s.kt)("inlineCode",{parentName:"p"},"assetmeters")," to the new asset."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"POST /oslc/os/mxapiasset/{rest id for the asset} \nx-method-override: PATCH\npatchtype: MERGE \nproperties:*\n")),(0,s.kt)("p",null,"Post body:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "description": "test asset desc",\n  "assetmeter": [\n    {\n      "metername": "TEMP-F",\n      "linearassetid": 0\n    },\n    {\n      "metername": "ABC",\n      "linearassetid": 0\n    }\n  ]\n}\n')),(0,s.kt)("p",null,"An extra request header called ",(0,s.kt)("inlineCode",{parentName:"p"},"patchtype")," is used with a value of ",(0,s.kt)("inlineCode",{parentName:"p"},"MERGE"),". This instructs the server to match the child objects - like ",(0,s.kt)("inlineCode",{parentName:"p"},"assetmeter")," with the existing",(0,s.kt)("inlineCode",{parentName:"p"},"assetmters")," for this asset. If a match is found, that ",(0,s.kt)("inlineCode",{parentName:"p"},"assetmeter")," gets updates with the request assetmeter. If a match is not found, an ",(0,s.kt)("inlineCode",{parentName:"p"},"assetmeter")," is created. This action is called the ",(0,s.kt)("inlineCode",{parentName:"p"},"MERGE")," API. For example, if the asset to be updated has three existing ",(0,s.kt)("inlineCode",{parentName:"p"},"assetmeters"),", and the request contained one existing\n",(0,s.kt)("inlineCode",{parentName:"p"},"assetmeter")," and one new ",(0,s.kt)("inlineCode",{parentName:"p"},"assetmeter"),", that asset will be having  4  ",(0,s.kt)("inlineCode",{parentName:"p"},"assetmeters"),"  with one newly created one and another updated ",(0,s.kt)("inlineCode",{parentName:"p"},"assetmeter")," after the merge call."),(0,s.kt)("p",null,"To highlight the difference between a ",(0,s.kt)("inlineCode",{parentName:"p"},"PATCH")," and ",(0,s.kt)("inlineCode",{parentName:"p"},"MERGE")," call, you can run the same request without the ",(0,s.kt)("inlineCode",{parentName:"p"},"patchtype")," header on another similar asset with  three ",(0,s.kt)("inlineCode",{parentName:"p"}," assetmeters"),". The server side creates a new ",(0,s.kt)("inlineCode",{parentName:"p"},"assetmeter")," and update the existing ",(0,s.kt)("inlineCode",{parentName:"p"},"assetmeter")," like the ",(0,s.kt)("inlineCode",{parentName:"p"},"MERGE")," call. Unlike the ",(0,s.kt)("inlineCode",{parentName:"p"},"MERGE")," call, the ",(0,s.kt)("inlineCode",{parentName:"p"},"assetmeters")," that were not in the request are deleted. In this example, only two ",(0,s.kt)("inlineCode",{parentName:"p"}," assetmeters")," (that are in the request) remains in the asset. Thus in a ",(0,s.kt)("inlineCode",{parentName:"p"},"PATCH")," request, the server side deletes all child objects that are not in the request payload."),(0,s.kt)("h2",null,"Updating child objects"),(0,s.kt)("p",null,"To update the child objects, the following example updates the ",(0,s.kt)("inlineCode",{parentName:"p"},"assetmeter")," object to set the meter reading. Make sure that the ",(0,s.kt)("inlineCode",{parentName:"p"},"np")," attributes, ",(0,s.kt)("inlineCode",{parentName:"p"},"newreading")," and ",(0,s.kt)("inlineCode",{parentName:"p"},"newreadingdate")," are included in the ",(0,s.kt)("inlineCode",{parentName:"p"},"MXAPIASSET")," object structure."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"POST /oslc/os/mxapiasset/{rest id for the asset} \nx-method-override: PATCH\npatchtype: MERGE \nproperties:*\n")),(0,s.kt)("p",null,"Post body:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "description": "test asset desc - updating temp meter",\n  "assetmeter": [\n    {\n      "metername": "TEMP-F",\n      "linearassetid": 0,\n      "newreading": "10"\n    }\n  ]\n}\n')),(0,s.kt)("p",null,"Notice that the primary keys of the ",(0,s.kt)("inlineCode",{parentName:"p"},"assetmeter")," - ",(0,s.kt)("inlineCode",{parentName:"p"},"metername")," and ",(0,s.kt)("inlineCode",{parentName:"p"},"linearassetid")," for the meter update are included. Another option that the API allows is to use the href URI for the ",(0,s.kt)("inlineCode",{parentName:"p"},"assetmeter")," instead of the primary keys, which is shown in the following example:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-http"},'POST /oslc/os/mxapiasset/{rest id for the asset} \nx-method-override: PATCH\npatchtype: MERGE \nproperties:*\n\n{\n  "description": "test asset desc - updating temp meter with child uri",\n  "assetmeter": [\n    {\n      "href": "parent uri#encoded_child_keys_anchored",\n      "newreading": "10"\n    }\n  ]\n}\n')),(0,s.kt)("h2",null,"Delete child objects"),(0,s.kt)("p",null,"The following request below shows how to selectively delete a child object:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'POST /oslc/os/mxapiasset/{rest id for the asset} \nx-method-override: PATCH\npatchtype: MERGE\nproperties:*\n\n{\n  "assetmeter": [\n    {\n      "metername": "TEMP-F",\n      "linearassetid": 0,\n      "_action": "Delete"\n    }\n  ]\n}\n')),(0,s.kt)("p",null,"Note the use of child level actions (",(0,s.kt)("inlineCode",{parentName:"p"},"_action"),") to delete the ",(0,s.kt)("inlineCode",{parentName:"p"},"assetmeter"),". You could have also used the child href instead of the primary keys as shown before. You could have also used the http ",(0,s.kt)("inlineCode",{parentName:"p"},"DELETE")," method to delete the child object using the child object ",(0,s.kt)("inlineCode",{parentName:"p"},"localuri")," URI."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"DELETE <assetmeter localuri>\n")),(0,s.kt)("p",null,"Note the local URI for a child object (in Object structure) is something you can use to refer directly to the child object. You cannot do the same with the child href as that is an anchored URI. For example, you cannot use the child href for http ",(0,s.kt)("inlineCode",{parentName:"p"},"DELETE"),"."),(0,s.kt)("p",null,"By using the POST method with the ",(0,s.kt)("inlineCode",{parentName:"p"},"_action")," child action, you can do a bulk delete of child objects, which you cannot do using the http ",(0,s.kt)("inlineCode",{parentName:"p"},"DELETE")," method."))}h.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-crud-create-and-update-mdx-6c5cccdd4344fa731b90.js.map