{"componentChunkName":"component---src-pages-file-import-mdx","path":"/file/import/","result":{"pageContext":{"frontmatter":{"title":"Supporting File Import (CSV/XML) Import Preview using REST api"},"relativePagePath":"/file/import.mdx","titleType":"append","MdxNode":{"id":"ee079d33-d763-5c8b-89cf-1cc7df394533","children":[],"parent":"2117ed76-1899-5d69-bac4-3e84a2530f43","internal":{"content":"---\ntitle: Supporting File Import (CSV/XML) Import Preview using REST api\n---\n\nyou can upload data from flat files or XML or JSON files to Maximo Asset Management by using RESTful API `action=importfile` by using the application import capability.\n\n## Prepare Object Structure\n\nTo import XML files, you do not need to configure the object structure. To import flat files, similar with the application import, you need to configure object structure to support the flat file structure. This implies there shouldn’t be any alias conflict for that specific object structure. To verify that, find the object structure, such as MXAPIMETER, in the Object Structure application. Make sure the Support Flat Structure check box is selected and no alias conflict is detected by the system (the Alias Conflict check box is clear). If there are any conflicting fields, select the Add/Modify Alias action and add a new alias to the conflicted field, starting with the first child object. The rest of this section focuses on flat files but XML files is the same with a different header value.\n\n## Security\n\nThere is no special requirement on security - it just follows the normal Object structure security concepts. This implies that you got to have support for INSERT/SAVE/DELETE sigoptions (for your corresponding security application for the object structure) to be able to import csv files.\n\n## Prepare CSV\n\nThe CSV format is the same as a typical application import in Maximo Asset Management. When you import files from CSV, the attribute name of each field must match with attribute alias in Maximo Asset Management.\n\nFor example, the CSV file content can be as follows\n```csv\nMETERNAME,METERTYPE,READINGTYPE,DESCRIPTION,MEASUREUNITID RUNHOURS2,CONTINUOUS,DELTA,Run Hours2,HOURS\nTEMP-F2,GAUGE,,Temperature in Fahrenheit2,DEG F\n```\n\n## Preview\n\nBefore processing the data into the database, you should validate if there any errors occured by using the preview functionality, which is supported in the import file API. For example:\n \n```\nPOST oslc/os/mxapimeter?action=importfile&lean=1 \nmaxauth:<base64 encoded user:password>\npreview:1\n```\nBody:\n```csv\nMETERNAME,METERTYPE,READINGTYPE,DESCRIPTION,MEASUREUNITID RUNHOURS2,CONTINUOUS,DELTA,Run Hours2,HOURS\nTEMP-F2,GAUGE,,Temperature in Fahrenheit2,DEG F\n```\n\nAfter you make the POST request to server, the system returns the preview response, which includes the validation information and warning messages and shown in the following error message example:\n\n```json\n{\n  \"invaliddoc\": 2,// how many invalid records \n  \"totaldoc\": 2,//how many records in csv file in total \n  \"validdoc\": 0,//how many valid records\n  \"warningmsg\": \"\\nBMXAA5598E - Processing of an inbound transaction failed. The processing exception is identified in document 1.\\n\\tBMXAA0024E - The action ADD is not allowed on object METER. Verify the business rules for the object and define the appropriate action for the object.\\nBMXAA5598E - Processing of an inbound transaction failed. The processing exception is identified in document 2.\\n\\tBMXAA0024E - The action ADD is not allowed on object METER. Verify the business rules for the object and define the appropriate action for the object.\" //the error messages for each record.\n}\n```\n\nYou can determine the problem from warning messages and then fix it. In the sample error responses, you can tell that the issue is caused by missing the security setup. After granting the sigoptions and reprocess the call, the successful preview looks like following example:\n\n```json\n{\n  \"invaliddoc\": 0,\n  \"totaldoc\": 2,\n  \"validdoc\": 2,\n  \"warningmsg\": \"\"\n}\n```\n \n## File Import\n\nAfter previewing, you can import the file into Maximo Asset Management by removing preview header from request:\n\n```\nPOST oslc/os/mxapimeter?action=importfile&lean=1\n```\nBody:\n```csv\nMETERNAME,METERTYPE,READINGTYPE,DESCRIPTION,MEASUREUNITID RUNHOURS2,CONTINUOUS,DELTA,Run Hours2,HOURS\nTEMP-F2,GAUGE,,Temperature in Fahrenheit2,DEG F\n```\n\nThe response is as follows:\n\n```json\n{\n  \"validdoc\": 2\n}\n```\n\nOther file types are supported, like XML/JSON, customized delimiter, and textqualifier. You can easily configure them with the following headers when you do the POST call.\n\n|Header|Description|Default value|\n|--|--|--|\n|filetype|The type of the uploading file, it can be FLAT or XML|FLAT|\n|delimiter|The delimiter of csv file|,|\n|textqualifier|When the data include any delimiter, it will be wrapped by textqualifier|\"|\n|preview|If the importfile API is running in preview mode. It can be 0 or 1|0|\n\n### Asynchronous File import\n\nWe can upload files asynchronously using the rest apis starting 7611. To do this just add the query parameter `async=1` and another query parameter `name=<some unique name identifying the load>`. The response would be a location url (in the response header) for the client program to poll to get status on the upload. The response of that polling is given in a json document that also indicates how many records have been processed so far which can be leveraged by the client program to show a progress indicator. At the end of the upload, the json document would contain the list of errors that it incurred as part of the upload and a embedded link to download the error file. The error file would be in the same format as the request upload file and will contain the error message along with the original data for each of the error records. Note that this error file only contains error records and not the ones that were processed successfully.\n\nInternally Maximo has a crontask (API_FILE) that processes the upload at a configurable frequency. ","type":"Mdx","contentDigest":"7c5018dd9c664eb88e9eb3f4c4a15544","owner":"gatsby-plugin-mdx","counter":165},"frontmatter":{"title":"Supporting File Import (CSV/XML) Import Preview using REST api"},"exports":{},"rawBody":"---\ntitle: Supporting File Import (CSV/XML) Import Preview using REST api\n---\n\nyou can upload data from flat files or XML or JSON files to Maximo Asset Management by using RESTful API `action=importfile` by using the application import capability.\n\n## Prepare Object Structure\n\nTo import XML files, you do not need to configure the object structure. To import flat files, similar with the application import, you need to configure object structure to support the flat file structure. This implies there shouldn’t be any alias conflict for that specific object structure. To verify that, find the object structure, such as MXAPIMETER, in the Object Structure application. Make sure the Support Flat Structure check box is selected and no alias conflict is detected by the system (the Alias Conflict check box is clear). If there are any conflicting fields, select the Add/Modify Alias action and add a new alias to the conflicted field, starting with the first child object. The rest of this section focuses on flat files but XML files is the same with a different header value.\n\n## Security\n\nThere is no special requirement on security - it just follows the normal Object structure security concepts. This implies that you got to have support for INSERT/SAVE/DELETE sigoptions (for your corresponding security application for the object structure) to be able to import csv files.\n\n## Prepare CSV\n\nThe CSV format is the same as a typical application import in Maximo Asset Management. When you import files from CSV, the attribute name of each field must match with attribute alias in Maximo Asset Management.\n\nFor example, the CSV file content can be as follows\n```csv\nMETERNAME,METERTYPE,READINGTYPE,DESCRIPTION,MEASUREUNITID RUNHOURS2,CONTINUOUS,DELTA,Run Hours2,HOURS\nTEMP-F2,GAUGE,,Temperature in Fahrenheit2,DEG F\n```\n\n## Preview\n\nBefore processing the data into the database, you should validate if there any errors occured by using the preview functionality, which is supported in the import file API. For example:\n \n```\nPOST oslc/os/mxapimeter?action=importfile&lean=1 \nmaxauth:<base64 encoded user:password>\npreview:1\n```\nBody:\n```csv\nMETERNAME,METERTYPE,READINGTYPE,DESCRIPTION,MEASUREUNITID RUNHOURS2,CONTINUOUS,DELTA,Run Hours2,HOURS\nTEMP-F2,GAUGE,,Temperature in Fahrenheit2,DEG F\n```\n\nAfter you make the POST request to server, the system returns the preview response, which includes the validation information and warning messages and shown in the following error message example:\n\n```json\n{\n  \"invaliddoc\": 2,// how many invalid records \n  \"totaldoc\": 2,//how many records in csv file in total \n  \"validdoc\": 0,//how many valid records\n  \"warningmsg\": \"\\nBMXAA5598E - Processing of an inbound transaction failed. The processing exception is identified in document 1.\\n\\tBMXAA0024E - The action ADD is not allowed on object METER. Verify the business rules for the object and define the appropriate action for the object.\\nBMXAA5598E - Processing of an inbound transaction failed. The processing exception is identified in document 2.\\n\\tBMXAA0024E - The action ADD is not allowed on object METER. Verify the business rules for the object and define the appropriate action for the object.\" //the error messages for each record.\n}\n```\n\nYou can determine the problem from warning messages and then fix it. In the sample error responses, you can tell that the issue is caused by missing the security setup. After granting the sigoptions and reprocess the call, the successful preview looks like following example:\n\n```json\n{\n  \"invaliddoc\": 0,\n  \"totaldoc\": 2,\n  \"validdoc\": 2,\n  \"warningmsg\": \"\"\n}\n```\n \n## File Import\n\nAfter previewing, you can import the file into Maximo Asset Management by removing preview header from request:\n\n```\nPOST oslc/os/mxapimeter?action=importfile&lean=1\n```\nBody:\n```csv\nMETERNAME,METERTYPE,READINGTYPE,DESCRIPTION,MEASUREUNITID RUNHOURS2,CONTINUOUS,DELTA,Run Hours2,HOURS\nTEMP-F2,GAUGE,,Temperature in Fahrenheit2,DEG F\n```\n\nThe response is as follows:\n\n```json\n{\n  \"validdoc\": 2\n}\n```\n\nOther file types are supported, like XML/JSON, customized delimiter, and textqualifier. You can easily configure them with the following headers when you do the POST call.\n\n|Header|Description|Default value|\n|--|--|--|\n|filetype|The type of the uploading file, it can be FLAT or XML|FLAT|\n|delimiter|The delimiter of csv file|,|\n|textqualifier|When the data include any delimiter, it will be wrapped by textqualifier|\"|\n|preview|If the importfile API is running in preview mode. It can be 0 or 1|0|\n\n### Asynchronous File import\n\nWe can upload files asynchronously using the rest apis starting 7611. To do this just add the query parameter `async=1` and another query parameter `name=<some unique name identifying the load>`. The response would be a location url (in the response header) for the client program to poll to get status on the upload. The response of that polling is given in a json document that also indicates how many records have been processed so far which can be leveraged by the client program to show a progress indicator. At the end of the upload, the json document would contain the list of errors that it incurred as part of the upload and a embedded link to download the error file. The error file would be in the same format as the request upload file and will contain the error message along with the original data for each of the error records. Note that this error file only contains error records and not the ones that were processed successfully.\n\nInternally Maximo has a crontask (API_FILE) that processes the upload at a configurable frequency. ","fileAbsolutePath":"/home/travis/build/maximo-app-framework/maximo-restapi-documentation/src/pages/file/import.mdx"}}},"staticQueryHashes":["1364590287","137577622","2102389209","2456312558","2746626797","3018647132","3037994772","768070550"]}